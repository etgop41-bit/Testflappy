<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DareMarket Flappy</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Rajdhani:wght@600;700&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #0a0a0a;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      font-family: 'Rajdhani', sans-serif;
    }

    #game-wrapper {
      position: relative;
      width: 480px;
      height: 640px;
    }

    canvas {
      display: block;
      border: 2px solid #ff1a1a;
      box-shadow: 0 0 40px #ff1a1a66, 0 0 80px #ff000033;
      border-radius: 4px;
    }

    #ui-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #score-display {
      margin-top: 20px;
      font-family: 'Bebas Neue', cursive;
      font-size: 72px;
      color: #fff;
      text-shadow: 0 0 20px #ff1a1a, 0 2px 0 #000;
      letter-spacing: 4px;
    }

    #screen {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.78);
      pointer-events: all;
      transition: opacity 0.3s;
    }

    #screen.hidden { display: none; }

    #screen h1 {
      font-family: 'Bebas Neue', cursive;
      font-size: 58px;
      color: #ff1a1a;
      text-shadow: 0 0 30px #ff000099;
      letter-spacing: 6px;
      margin-bottom: 4px;
    }

    #screen .subtitle {
      font-size: 18px;
      color: #aaa;
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 30px;
    }

    #screen .logo-wrap {
      margin-bottom: 20px;
    }
    #screen .logo-wrap img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      filter: drop-shadow(0 0 20px #ff1a1a);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%,100% { filter: drop-shadow(0 0 15px #ff1a1a); transform: scale(1); }
      50% { filter: drop-shadow(0 0 35px #ff4444); transform: scale(1.06); }
    }

    .btn {
      pointer-events: all;
      cursor: pointer;
      font-family: 'Bebas Neue', cursive;
      font-size: 28px;
      letter-spacing: 4px;
      padding: 14px 48px;
      background: #ff1a1a;
      color: #fff;
      border: none;
      border-radius: 2px;
      box-shadow: 0 0 20px #ff000066;
      transition: all 0.15s;
      margin: 6px 0;
    }
    .btn:hover {
      background: #ff3333;
      box-shadow: 0 0 35px #ff000099;
      transform: scale(1.04);
    }

    #best-score {
      margin-top: 16px;
      font-size: 20px;
      color: #888;
      letter-spacing: 2px;
    }
    #best-score span { color: #ff4444; font-weight: bold; }

    #gameover-score {
      font-family: 'Bebas Neue', cursive;
      font-size: 48px;
      color: #fff;
      text-shadow: 0 0 20px #ff1a1a;
      margin-bottom: 6px;
    }

    #instructions {
      font-size: 15px;
      color: #666;
      letter-spacing: 2px;
      margin-top: 14px;
    }
  </style>
</head>
<body>
<div id="game-wrapper">
  <canvas id="gameCanvas" width="480" height="640"></canvas>
  <div id="ui-overlay">
    <div id="score-display">0</div>
  </div>

  <!-- Start Screen -->
  <div id="screen" id="startScreen">
    <div class="logo-wrap"><img src="logo.jpg" alt="DareMarket" /></div>
    <h1>DareMarket</h1>
    <div class="subtitle">Flappy Edition</div>
    <button class="btn" onclick="startGame()">PLAY</button>
    <div id="instructions">CLICK / TAP / SPACE to fly</div>
    <div id="best-score">BEST: <span id="best-val">0</span></div>
  </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

// Assets
const logoImg = new Image();
logoImg.src = 'logo.jpg';
const charImg = new Image();
charImg.src = 'character.png';

let gameState = 'start'; // start, playing, dead
let score = 0, bestScore = 0;
let animFrame;

// Bird
const BIRD_W = 70, BIRD_H = 120;
let bird = { x: 120, y: H/2, vy: 0, rotation: 0 };
const GRAVITY = 0.45;
const JUMP = -9;

// Pipes
const PIPE_W = 80;
const GAP = 190;
const PIPE_SPEED = 3;
let pipes = [];
let pipeTimer = 0;
const PIPE_INTERVAL = 100;

// Background stars
let stars = Array.from({length:60}, () => ({
  x: Math.random()*W, y: Math.random()*H,
  r: Math.random()*1.5+0.5, a: Math.random()
}));

// Ground
const GROUND_H = 60;

let scoreDisplay = document.getElementById('score-display');
let screen = document.getElementById('screen');

function drawBackground() {
  // Dark gradient sky
  let grad = ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0, '#0a0005');
  grad.addColorStop(1, '#1a0010');
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,W,H);

  // Stars
  stars.forEach(s => {
    s.a += 0.02;
    let alpha = 0.4 + 0.4*Math.sin(s.a);
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
    ctx.fillStyle = `rgba(255,100,100,${alpha})`;
    ctx.fill();
  });

  // Ground
  let gGrad = ctx.createLinearGradient(0, H-GROUND_H, 0, H);
  gGrad.addColorStop(0, '#1a0a0a');
  gGrad.addColorStop(1, '#0a0505');
  ctx.fillStyle = gGrad;
  ctx.fillRect(0, H-GROUND_H, W, GROUND_H);

  // Ground line
  ctx.strokeStyle = '#ff1a1a';
  ctx.lineWidth = 2;
  ctx.shadowColor = '#ff1a1a';
  ctx.shadowBlur = 10;
  ctx.beginPath();
  ctx.moveTo(0, H-GROUND_H);
  ctx.lineTo(W, H-GROUND_H);
  ctx.stroke();
  ctx.shadowBlur = 0;

  // Ground text
  ctx.fillStyle = '#ff1a1a44';
  ctx.font = 'bold 13px Rajdhani';
  ctx.letterSpacing = '4px';
  ctx.fillText('DARE MARKET • DARE MARKET • DARE MARKET • DARE MARKET • DARE MARKET', -20, H-20);
}

function drawPipe(pipe) {
  const logoSize = PIPE_W;

  // Top pipe body
  let topH = pipe.topH;
  let botY = pipe.topH + GAP;
  let botH = H - GROUND_H - botY;

  // Draw top pipe
  let tg = ctx.createLinearGradient(pipe.x, 0, pipe.x+PIPE_W, 0);
  tg.addColorStop(0, '#1a0000');
  tg.addColorStop(0.5, '#330000');
  tg.addColorStop(1, '#1a0000');
  ctx.fillStyle = tg;
  ctx.fillRect(pipe.x, 0, PIPE_W, topH);

  // Top pipe edge glow
  ctx.strokeStyle = '#ff1a1a';
  ctx.lineWidth = 2;
  ctx.shadowColor = '#ff1a1a';
  ctx.shadowBlur = 12;
  ctx.strokeRect(pipe.x, 0, PIPE_W, topH);
  ctx.shadowBlur = 0;

  // Bottom pipe body
  ctx.fillStyle = tg;
  ctx.fillRect(pipe.x, botY, PIPE_W, botH);
  ctx.strokeStyle = '#ff1a1a';
  ctx.lineWidth = 2;
  ctx.shadowColor = '#ff1a1a';
  ctx.shadowBlur = 12;
  ctx.strokeRect(pipe.x, botY, PIPE_W, botH);
  ctx.shadowBlur = 0;

  // DareMarket logo on top pipe (bottom edge)
  if (logoImg.complete && topH >= logoSize) {
    ctx.save();
    ctx.beginPath();
    ctx.rect(pipe.x, topH - logoSize, PIPE_W, logoSize);
    ctx.clip();
    ctx.drawImage(logoImg, pipe.x, topH - logoSize, logoSize, logoSize);
    ctx.restore();
  }

  // DareMarket logo on bottom pipe (top edge)
  if (logoImg.complete && botH >= logoSize) {
    ctx.save();
    ctx.beginPath();
    ctx.rect(pipe.x, botY, PIPE_W, logoSize);
    ctx.clip();
    ctx.drawImage(logoImg, pipe.x, botY, logoSize, logoSize);
    ctx.restore();
  }
}

function drawBird() {
  ctx.save();
  ctx.translate(bird.x, bird.y);
  // Tilt based on velocity
  let angle = Math.max(-0.5, Math.min(0.8, bird.vy * 0.05));
  ctx.rotate(angle);
  // Draw character centered
  if (charImg.complete) {
    ctx.drawImage(charImg, -BIRD_W/2, -BIRD_H/2, BIRD_W, BIRD_H);
  } else {
    ctx.fillStyle = '#ff1a1a';
    ctx.fillRect(-BIRD_W/2, -BIRD_H/2, BIRD_W, BIRD_H);
  }

  // Green glow outline effect (matching character's outline)
  ctx.shadowColor = '#00ff44';
  ctx.shadowBlur = 12;
  ctx.shadowBlur = 0;
  ctx.restore();
}

function spawnPipe() {
  let topH = 80 + Math.random() * (H - GROUND_H - GAP - 120);
  pipes.push({ x: W + 10, topH, scored: false });
}

function updateBird() {
  bird.vy += GRAVITY;
  bird.y += bird.vy;
}

function checkCollision() {
  let bx = bird.x - BIRD_W/2 + 10;
  let bw = BIRD_W - 20;
  let by = bird.y - BIRD_H/2 + 10;
  let bh = BIRD_H - 20;

  // Ground/ceiling
  if (bird.y + BIRD_H/2 > H - GROUND_H || bird.y - BIRD_H/2 < 0) return true;

  for (let p of pipes) {
    if (bx + bw > p.x && bx < p.x + PIPE_W) {
      if (by < p.topH || by + bh > p.topH + GAP) return true;
    }
  }
  return false;
}

function gameLoop() {
  ctx.clearRect(0,0,W,H);
  drawBackground();

  if (gameState === 'playing') {
    // Update pipes
    pipeTimer++;
    if (pipeTimer >= PIPE_INTERVAL) {
      spawnPipe();
      pipeTimer = 0;
    }
    pipes.forEach(p => p.x -= PIPE_SPEED);
    pipes = pipes.filter(p => p.x + PIPE_W > -10);

    // Score
    pipes.forEach(p => {
      if (!p.scored && p.x + PIPE_W < bird.x) {
        p.scored = true;
        score++;
        scoreDisplay.textContent = score;
      }
    });

    updateBird();

    if (checkCollision()) {
      gameState = 'dead';
      showGameOver();
      return;
    }
  }

  // Draw pipes
  pipes.forEach(drawPipe);
  drawBird();

  animFrame = requestAnimationFrame(gameLoop);
}

function flap() {
  if (gameState === 'start') { startGame(); return; }
  if (gameState === 'playing') bird.vy = JUMP;
}

function startGame() {
  screen.classList.add('hidden');
  score = 0;
  scoreDisplay.textContent = '0';
  bird = { x: 120, y: H/2, vy: 0 };
  pipes = [];
  pipeTimer = 0;
  gameState = 'playing';
  cancelAnimationFrame(animFrame);
  gameLoop();
}

function showGameOver() {
  if (score > bestScore) bestScore = score;
  screen.innerHTML = `
    <div class="logo-wrap"><img src="logo.jpg" alt="DareMarket" /></div>
    <h1>GAME OVER</h1>
    <div id="gameover-score">${score}</div>
    <div class="subtitle">SCORE</div>
    <button class="btn" onclick="startGame()">RETRY</button>
    <div id="best-score">BEST: <span>${bestScore}</span></div>
  `;
  screen.classList.remove('hidden');
  gameLoop(); // keep drawing last frame
}

// Input
document.addEventListener('keydown', e => { if (e.code === 'Space' || e.code === 'ArrowUp') { e.preventDefault(); flap(); } });
canvas.addEventListener('click', flap);
canvas.addEventListener('touchstart', e => { e.preventDefault(); flap(); });

// Initial render
gameLoop();
</script>
</body>
</html>
